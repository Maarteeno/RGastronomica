<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Brain Buddy">
    <meta name="theme-color" content="#ffffff">

    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect width='512' height='512' rx='100' fill='%236c5ce7'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='central' text-anchor='middle' font-size='250'%3Eüß†%3C/text%3E%3C/svg%3E">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Crect width='512' height='512' rx='100' fill='%236c5ce7'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='central' text-anchor='middle' font-size='250'%3Eüß†%3C/text%3E%3C/svg%3E">

    <title>Brain Buddy</title>
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: rgba(255, 255, 255, 0.98);
            --text: #2d3436;
            --text-light: #636e72;
            --radius: 24px;
            --shadow: 0 15px 35px rgba(0,0,0,0.2);
            /* Paleta */
            --c-wordle: #27ae60;
            --c-sopa: #2980b9;
            --c-sudoku: #e67e22;
            --c-memo: #9b59b6;
            --c-simon: #e74c3c;
            --c-math: #1abc9c;
            /* Sudoku especifico */
            --sudo-border: #2d3436;
            --sudo-fixed-bg: rgba(0,0,0,0.05);
            --sudo-fixed-text: #2980b9;
        }

        body.dark-mode {
            --bg-gradient: linear-gradient(135deg, #2c3e50 0%, #000000 100%);
            --card-bg: rgba(30, 39, 46, 0.98);
            --text: #ecf0f1;
            --text-light: #bdc3c7;
            --shadow: 0 15px 35px rgba(0,0,0,0.6);
            /* Sudoku dark */
            --sudo-border: #ecf0f1;
            --sudo-fixed-bg: rgba(255,255,255,0.1);
            --sudo-fixed-text: #3498db;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            /* Safe area para iPhone */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .app {
            background: var(--card-bg);
            width: 100%;
            max-width: 500px;
            height: 95vh;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* --- PANTALLAS --- */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            /* Espacio superior para bot√≥n tema y barra estado */
            padding: 70px 20px 50px 20px; 
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }
        .screen.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- CABECERA Y T√çTULOS --- */
        h1 { margin: 10px 0 20px 0; font-size: 2.2rem; text-align: center; font-weight: 800; letter-spacing: -1px; }
        
        .nav { 
            width: 100%; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 15px; 
            padding-bottom: 10px; 
            border-bottom: 2px solid rgba(128,128,128,0.1);
            position: relative; 
        }
        
        .nav h2 { 
            font-size: 1.4rem; 
            margin: 0; 
            font-weight: 700; 
            text-align: center; 
            flex-grow: 1;       
            padding-left: 10px; 
        }

        .nav-controls { display: flex; gap: 8px; z-index: 2; }

        /* --- BOT√ìN TEMA --- */
        .theme-switch {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 42px; height: 42px;
            background: rgba(128,128,128,0.15);
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 1.3rem;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
        }

        /* --- COPYRIGHT --- */
        .copyright {
            position: absolute;
            bottom: 15px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-light);
            opacity: 0.6;
            pointer-events: none;
            z-index: 5;
        }

        /* --- MEN√ö GRID --- */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            width: 100%;
            margin-bottom: 20px;
        }
        .menu-btn {
            border: none; border-radius: 18px; padding: 15px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; color: white; box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            aspect-ratio: 1.2; transition: transform 0.1s;
        }
        .menu-btn:active { transform: scale(0.96); }
        .menu-emoji { font-size: 2.2rem; margin-bottom: 5px; }
        .menu-label { font-size: 0.9rem; font-weight: bold; text-transform: uppercase; }
        
        .bg-wordle { background: var(--c-wordle); }
        .bg-simon { background: var(--c-simon); }
        .bg-sopa { background: var(--c-sopa); }
        .bg-memo { background: var(--c-memo); }
        .bg-sudoku { background: var(--c-sudoku); }
        .bg-math { background: var(--c-math); }

        /* UI ELEMENTS */
        .btn {
            background: var(--card-bg); border: 1px solid rgba(128,128,128,0.3);
            color: var(--text); padding: 14px; border-radius: 12px;
            font-size: 1rem; font-weight: 700; cursor: pointer; width: 100%; margin-bottom: 8px;
        }
        .btn-icon { width: 38px; height: 38px; border-radius: 10px; border: none; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; cursor: pointer; }
        .btn-restart { background: rgba(52, 152, 219, 0.15); color: #3498db; }
        .btn-exit { background: rgba(231, 76, 60, 0.15); color: #e74c3c; }
        .btn-back { background: transparent; border: 1px solid rgba(128,128,128,0.3); color: var(--text); width: auto; padding: 0 15px; font-size: 0.9rem; }
        .timer-badge { font-family: monospace; font-size: 1.1rem; color: var(--c-sudoku); background: rgba(128,128,128,0.1); padding: 5px 10px; border-radius: 8px; font-weight: bold; }

        /* RECORDS BOX */
        .records-box {
            width: 100%;
            background: rgba(128,128,128,0.05);
            border-radius: 16px;
            padding: 15px;
            margin-top: auto;
            margin-bottom: 30px; 
            font-size: 0.85rem;
        }
        .record-title { text-align: center; font-weight: bold; margin-bottom: 8px; letter-spacing: 1px; color: var(--text-light); }
        .record-list { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .record-item { display: flex; justify-content: space-between; padding: 6px 10px; background: var(--card-bg); border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .rec-name { font-weight: bold; color: var(--c-sopa); }
        .records-note { text-align: center; margin-top: 10px; opacity: 0.6; font-size: 0.75rem; font-style: italic; }
        .cloud-actions { display: flex; gap: 10px; margin-top: 15px; justify-content: center; }
        .btn-cloud { background: transparent; border: 1px solid rgba(128,128,128,0.3); padding: 8px 12px; border-radius: 8px; color: var(--text); font-size: 0.8rem; cursor: pointer; }

        /* --- JUEGOS --- */
        
        /* Wordle */
        .wordle-grid { display: grid; gap: 5px; margin-bottom: 15px; justify-content: center; }
        .wordle-cell { width: 45px; height: 45px; border: 2px solid rgba(128,128,128,0.3); border-radius: 6px; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; font-weight: bold; text-transform: uppercase; }
        .wordle-cell.correct { background: var(--c-wordle); color: white; border-color: var(--c-wordle); }
        .wordle-cell.present { background: #f1c40f; color: white; border-color: #f1c40f; }
        .wordle-cell.absent { background: #7f8c8d; color: white; border-color: #7f8c8d; }
        .keyboard { display: flex; flex-direction: column; gap: 4px; width: 100%; max-width: 400px; }
        .key-row { display: flex; justify-content: center; gap: 3px; }
        .key { flex: 1; padding: 12px 0; background: rgba(128,128,128,0.15); border-radius: 4px; text-align: center; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
        .key.correct { background: var(--c-wordle); color: white; } .key.present { background: #f1c40f; color: white; } .key.absent { opacity: 0.3; }

        /* Simon */
        .simon-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; aspect-ratio: 1; max-width: 300px; margin: 20px auto; }
        .simon-btn { border-radius: 20px; cursor: pointer; opacity: 0.5; border: none; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; color: rgba(255,255,255,0.9); transition: 0.1s; box-shadow: inset 0 0 20px rgba(0,0,0,0.1); font-weight: bold; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
        .simon-btn.active { opacity: 1; transform: scale(0.95); box-shadow: 0 0 25px currentColor; color: white; }
        .s-0 { background: #2ecc71; color: #2ecc71; } .s-1 { background: #e74c3c; color: #e74c3c; } .s-2 { background: #f1c40f; color: #f1c40f; } .s-3 { background: #3498db; color: #3498db; }

        /* Sopa */
        #sopa-grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 2px; width: 100%; aspect-ratio: 1; margin-bottom: 10px; user-select: none; }
        .cell { background: rgba(128,128,128,0.1); border-radius: 3px; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 0.9rem; cursor: pointer; }
        .cell.highlight { background: var(--c-sopa); color: white; } .cell.found { background: #27ae60; color: white; }

        /* Sudoku */
        #sudoku-board { display: grid; grid-template-columns: repeat(9, 1fr); gap: 1px; background: var(--sudo-border); border: 2px solid var(--sudo-border); width: 100%; max-width: 360px; aspect-ratio: 1; margin-bottom: 10px; }
        .sudo-cell { background: var(--card-bg); display: flex; justify-content: center; align-items: center; font-size: 1.3rem; cursor: pointer; color: var(--text); }
        .sudo-cell.fixed { background: var(--sudo-fixed-bg); font-weight: 800; color: var(--sudo-fixed-text); } 
        .sudo-cell.selected { background: var(--c-sudoku) !important; color: white !important; }
        .numpad { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; width: 100%; max-width: 360px; margin-top: 10px; }
        .num-btn { padding: 12px; background: var(--card-bg); border: 1px solid rgba(128,128,128,0.3); border-radius: 8px; font-size: 1.3rem; cursor: pointer; color: var(--text); font-weight: bold; }

        /* Memory (4x4) */
        #memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; width: 100%; max-width: 360px; }
        .card { aspect-ratio: 1; background: var(--c-memo); border-radius: 8px; cursor: pointer; display: flex; justify-content: center; align-items: center; font-size: 2.2rem; color: transparent; transition: transform 0.2s; }
        .card.flipped { background: white; border: 2px solid var(--c-memo); color: initial; transform: rotateY(180deg); }

        /* Math */
        .math-box { background: rgba(128,128,128,0.1); padding: 20px; border-radius: 16px; text-align: center; width: 100%; margin-bottom: 20px; }
        .math-opts { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }

        .confetti { position: absolute; width: 10px; height: 10px; animation: fall linear forwards; pointer-events: none; z-index: 1001; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }
    </style>
</head>
<body>

<div class="app">
    <div class="theme-switch" onclick="toggleTheme()">üåì</div>

    <div id="screen-home" class="screen active">
        <h1>üß† Brain Buddy</h1>
        
        <div class="menu-grid">
            <button class="menu-btn bg-wordle" onclick="showWordleMenu()">
                <div class="menu-emoji">üü©</div><div class="menu-label">Palabra</div>
            </button>
            <button class="menu-btn bg-simon" onclick="showSimonMenu()">
                <div class="menu-emoji">üî¥</div><div class="menu-label">Simon</div>
            </button>
            <button class="menu-btn bg-sopa" onclick="showSopaMenu()">
                <div class="menu-emoji">üî§</div><div class="menu-label">Sopa</div>
            </button>
            <button class="menu-btn bg-memo" onclick="initMemory()">
                <div class="menu-emoji">üÉè</div><div class="menu-label">Memoria</div>
            </button>
            <button class="menu-btn bg-sudoku" onclick="initSudoku()">
                <div class="menu-emoji">üî¢</div><div class="menu-label">Sudoku</div>
            </button>
            <button class="menu-btn bg-math" onclick="initMath()">
                <div class="menu-emoji">üßÆ</div><div class="menu-label">C√°lculo</div>
            </button>
        </div>

        <div class="records-box">
            <div class="record-title">üèÜ TUS R√âCORDS</div>
            <div id="rec-list" class="record-list"></div>
            <div class="records-note">Los r√©cords se guardan localmente en este dispositivo.</div>
            <div class="cloud-actions">
                <button class="btn-cloud" onclick="exportData()">‚òÅÔ∏è Guardar</button>
                <button class="btn-cloud" onclick="importData()">üì• Cargar</button>
                <button class="btn-cloud" onclick="clearRecords()">üóëÔ∏è Reset</button>
            </div>
        </div>
    </div>

    <div id="screen-wordle-menu" class="screen">
        <div class="nav"><h2>Longitud</h2><div class="nav-controls"><button class="btn-icon btn-back" onclick="goHome()">Volver</button></div></div>
        <button class="btn" onclick="initWordle(4)">4 Letras</button>
        <button class="btn" onclick="initWordle(5)">5 Letras</button>
        <button class="btn" onclick="initWordle(6)">6 Letras</button>
        <button class="btn" onclick="initWordle(7)">7 Letras</button>
    </div>
    <div id="screen-wordle-game" class="screen">
        <div class="nav"><h2>Palabra</h2><div class="nav-controls"><button class="btn-icon btn-restart" onclick="initWordle(currentWordleLen)">‚Ü∫</button><button class="btn-icon btn-exit" onclick="showWordleMenu()">‚úñ</button></div></div>
        <div class="wordle-grid" id="wordle-board"></div>
        <div class="keyboard" id="keyboard"></div>
    </div>

    <div id="screen-simon-menu" class="screen">
        <div class="nav"><h2>Tema Simon</h2><div class="nav-controls"><button class="btn-icon btn-back" onclick="goHome()">Volver</button></div></div>
        <button class="btn" onclick="initSimon('classic')">üé® Cl√°sico (Colores)</button>
        <button class="btn" onclick="initSimon('days')">üìÜ D√≠as (Lun/Mar)</button>
        <button class="btn" onclick="initSimon('numbers')">üî¢ N√∫meros (1-4)</button>
        <button class="btn" onclick="initSimon('food')">üçî Comida</button>
    </div>
    <div id="screen-simon-game" class="screen">
        <div class="nav"><h2>Simon</h2><div class="nav-controls"><button class="btn-icon btn-restart" onclick="initSimon(currentSimonTheme)">‚Ü∫</button><button class="btn-icon btn-exit" onclick="showSimonMenu()">‚úñ</button></div></div>
        <div style="text-align:center; margin-bottom:15px; font-size:1.5rem;">Nivel: <span id="simon-level" style="font-weight:bold; color:var(--c-simon)">1</span></div>
        <div class="simon-grid">
            <button id="sb-0" class="simon-btn s-0" onclick="handleSimon(0)"></button>
            <button id="sb-1" class="simon-btn s-1" onclick="handleSimon(1)"></button>
            <button id="sb-2" class="simon-btn s-2" onclick="handleSimon(2)"></button>
            <button id="sb-3" class="simon-btn s-3" onclick="handleSimon(3)"></button>
        </div>
        <button id="simon-start-btn" class="btn" style="background:var(--c-simon); color:white; margin-top:20px;" onclick="startSimonRound()">Comenzar</button>
    </div>

    <div id="screen-sopa-menu" class="screen">
        <div class="nav"><h2>Tema Sopa</h2><div class="nav-controls"><button class="btn-icon btn-back" onclick="goHome()">Volver</button></div></div>
        <button class="btn" onclick="initSopa('paises')">üåç Pa√≠ses</button>
        <button class="btn" onclick="initSopa('comidas')">üçï Comidas</button>
        <button class="btn" onclick="initSopa('animales')">üê∂ Animales</button>
        <button class="btn" onclick="initSopa('todo')">üöÄ Mix</button>
    </div>
    <div id="screen-sopa-game" class="screen">
        <div class="nav"><h2 id="sopa-title"></h2><div class="nav-controls"><div id="timer-sopa" class="timer-badge">00:00</div><button class="btn-icon btn-restart" onclick="initSopa(sCurrentCat)">‚Ü∫</button><button class="btn-icon btn-exit" onclick="showSopaMenu()">‚úñ</button></div></div>
        <div id="sopa-grid"></div>
        <div id="sopa-words" style="display:flex; flex-wrap:wrap; gap:5px; justify-content:center; margin-top:10px;"></div>
    </div>

    <div id="screen-sudoku" class="screen">
        <div class="nav"><h2>Sudoku</h2><div class="nav-controls"><div id="timer-sudoku" class="timer-badge">00:00</div><button class="btn-icon btn-restart" onclick="initSudoku()">‚Ü∫</button><button class="btn-icon btn-exit" onclick="goHome()">‚úñ</button></div></div>
        <div id="sudoku-board"></div>
        <div class="numpad">
            <button class="num-btn" onclick="fillSudoku(1)">1</button><button class="num-btn" onclick="fillSudoku(2)">2</button><button class="num-btn" onclick="fillSudoku(3)">3</button><button class="num-btn" onclick="fillSudoku(4)">4</button><button class="num-btn" onclick="fillSudoku(5)">5</button>
            <button class="num-btn" onclick="fillSudoku(6)">6</button><button class="num-btn" onclick="fillSudoku(7)">7</button><button class="num-btn" onclick="fillSudoku(8)">8</button><button class="num-btn" onclick="fillSudoku(9)">9</button><button class="num-btn" style="color:var(--c-simon)" onclick="fillSudoku(null)">‚å´</button>
        </div>
        <button class="btn" style="margin-top:15px; background:var(--c-sudoku); color:white" onclick="checkSudoku()">Verificar</button>
    </div>

    <div id="screen-memory" class="screen">
        <div class="nav"><h2>Memoria</h2><div class="nav-controls"><div id="timer-memory" class="timer-badge">00:00</div><button class="btn-icon btn-restart" onclick="initMemory()">‚Ü∫</button><button class="btn-icon btn-exit" onclick="goHome()">‚úñ</button></div></div>
        <h4 id="memo-theme-label" style="margin:0 0 15px 0; color:var(--text-light); text-align:center;"></h4>
        <div id="memory-grid"></div>
    </div>

    <div id="screen-math" class="screen">
        <div class="nav"><h2>C√°lculo</h2><div class="nav-controls"><button class="btn-icon btn-restart" onclick="initMath()">‚Ü∫</button><button class="btn-icon btn-exit" onclick="stopGame(); goHome()">‚úñ</button></div></div>
        <div class="math-box">
            <div id="math-eq" style="font-size:3rem; font-weight:bold; margin-bottom:5px;"></div>
            <div>Puntos: <span id="math-score" style="font-weight:bold; color:var(--c-math)">0</span> | <span id="math-time">30</span>s</div>
        </div>
        <div id="math-opts" class="math-opts"></div>
    </div>

    <div class="copyright">¬© Maarteeno 2026</div>
</div>

<script>
    /* ================= SYSTEM ================= */
    let gameInterval = null;
    let timeElapsed = 0;
    
    // Configuraci√≥n de Juegos
    const GAMES_CONFIG = {
        wordle: { label: "Palabra", type: "score" },
        simon:  { label: "Simon", type: "max" },
        sopa:   { label: "Sopa", type: "min" },
        memo:   { label: "Memoria", type: "min" },
        sudoku: { label: "Sudoku", type: "min" },
        math:   { label: "C√°lculo", type: "max" }
    };

    // Navegaci√≥n
    function showScreen(id) { 
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(id === 'screen-home') updateRecordDisplay();
    }
    function goHome() { stopGame(); showScreen('screen-home'); }
    function showWordleMenu() { stopGame(); showScreen('screen-wordle-menu'); }
    function showSimonMenu() { stopGame(); showScreen('screen-simon-menu'); }
    function showSopaMenu() { stopGame(); showScreen('screen-sopa-menu'); }
    function toggleTheme() { document.body.classList.toggle('dark-mode'); }
    
    // Timer Global
    function stopGame() { clearInterval(gameInterval); clearInterval(simonTimer); clearInterval(mathTimer); }
    function startTimer(displayId) {
        stopGame(); timeElapsed = 0;
        const el = document.getElementById(displayId);
        if(el) el.textContent = "00:00";
        gameInterval = setInterval(() => {
            timeElapsed++;
            let m = Math.floor(timeElapsed / 60).toString().padStart(2, '0');
            let s = (timeElapsed % 60).toString().padStart(2, '0');
            if(el) el.textContent = `${m}:${s}`;
        }, 1000);
    }

    // Efectos
    function fireConfetti() {
        for(let i=0; i<40; i++) {
            let c = document.createElement('div'); c.className = 'confetti';
            c.style.left = Math.random()*100 + '%'; c.style.top = '-10px';
            c.style.backgroundColor = `hsl(${Math.random()*360},100%,50%)`;
            c.style.animationDuration = (Math.random()*2+1) + 's';
            document.body.appendChild(c);
            setTimeout(() => c.remove(), 3000);
        }
    }

    /* ================= RECORDS SYSTEM ================= */
    function checkRecord(gameKey, score) {
        let key = 'bg_rec_' + gameKey;
        let saved = JSON.parse(localStorage.getItem(key));
        if (!saved) saved = { name: '-', val: (GAMES_CONFIG[gameKey].type === 'min' ? 999999 : 0) };

        let isNew = false;
        if (GAMES_CONFIG[gameKey].type === 'min') {
            if (score < saved.val) isNew = true;
        } else {
            if (score > saved.val) isNew = true;
        }

        if (isNew) {
            let display = (GAMES_CONFIG[gameKey].type === 'min') ? formatTime(score) : score;
            let name = prompt(`¬°NUEVO R√âCORD!\nJuego: ${GAMES_CONFIG[gameKey].label}\nMarca: ${display}\n\nTu nombre:`);
            if (name) {
                localStorage.setItem(key, JSON.stringify({ name: name.substring(0,10), val: score }));
            }
        }
    }

    function formatTime(s) {
        let m = Math.floor(s / 60).toString().padStart(2, '0');
        let sec = (s % 60).toString().padStart(2, '0');
        return `${m}:${sec}`;
    }

    function updateRecordDisplay() {
        const list = document.getElementById('rec-list');
        list.innerHTML = '';
        for (let k in GAMES_CONFIG) {
            let saved = JSON.parse(localStorage.getItem('bg_rec_' + k));
            let val = '--'; let name = '';
            if (saved) {
                name = saved.name;
                val = (GAMES_CONFIG[k].type === 'min') ? formatTime(saved.val) : saved.val;
                if(k==='wordle') val += ' wins';
            }
            let item = document.createElement('div'); item.className='record-item';
            item.innerHTML = `<span>${GAMES_CONFIG[k].label}</span> <span>${val} <small class="rec-name">${name}</small></span>`;
            list.appendChild(item);
        }
    }

    function exportData() { let d={}; ['wordle','sopa','sudoku','memo','simon','math'].forEach(k=>{let v=localStorage.getItem('bg_rec_'+k); if(v) d[k]=v;}); prompt("Copia:", btoa(JSON.stringify(d))); }
    function importData() { let c=prompt("Pega:"); if(!c)return; try{ let d=JSON.parse(atob(c)); for(let k in d) localStorage.setItem('bg_rec_'+k, d[k]); updateRecordDisplay(); alert("Ok"); }catch(e){alert("Error");} }
    function clearRecords() { if(confirm("¬øReset?")) { localStorage.clear(); updateRecordDisplay(); } }

    /* ================= 1. WORDLE (4-7) ================= */
    const WORDLE_DB = {
        4: ["GATO","CASA","AUTO","LAGO","MESA","PERA","ROPA","LUNA","SOLO","VINO","PATO","TORO","RIOS","LOTE","PISO","MANO","BOCA","PIEL","OJOS","PELO","DEDO","U√ëAS","CARA","CODO","PIES","ARCO","BODA","DAMA","FAMA","GOMA","HOJA","ISLA","JOYA","KILO","LEER","MAPA","NUBE","OLAS","PAPA","QUEM","RAMA","SALA","TAZA","URNA","VACA","YATE","ZONA"],
        5: ["PERRO","PLAYA","SUELO","CIELO","LIBRO","LLAVE","ARBOL","AVION","BARCO","CAMPO","CANTO","CARNE","CARTA","CASCO","CEBRA","CESTA","CLASE","COCHE","COLOR","COMER","CORAL","CREMA","CRUDO","DADO","DANZA","DARDO","DATOS","DIETA","DISCO","DOBLE","DOLOR","DULCE","ENERO","ERROR","EXITO","FACIL","FALSO","FAUNA","FELIZ","FERIA","FIESTA","FINAL","FLOR","FUEGO","GAFAS","GANAR","GENTE","GLOBO","GOLPE","GORRA","GRASA","GRITO","GRUPO","GUAPO","GUSTO","HABER","HABLA","HACER","HACHA","HIELO","HIJO","HILO","HUEVO","HUMO","IDEA","IGUAL","ISLA","JABON","JAULA","JUEGO","JULIO","JUNIO","JUSTO","LABIO","LADO","LAGO","LANA","LARGO","LAPIZ","LECHE","LENTO","LEON","LETRA","LIBRO","LIMON","LINEA","LISTA","LLAMA","LLAVE","LOBO","LUGAR","LUNA","LUZ","MADRE","MAGIA","MAIZ","MANO","MAPA","MARCA","MARCO","MASA","MAYOR","MEDIO","MEJOR","MELON","MENOS","MENTE","MESA","METAL","METRO","MIEDO","MIEL","MITAD","MODA","MUNDO","MURO","NACER","NADAR","NARIZ","NAVE","NEGRO","NIEVE","NI√ëO","NOCHE","NORTE","NUBE","NUEVO","NUNCA","OESTE","OIDO","OJO","OLA","OLLA","ONDA","ORDEN","OREJA","ORO","OSO","OTO√ëO","PADRE","PAGAR","PAIS","PAJARO","PAN","PAPEL","PARAR","PARQUE","PASO","PASTO","PATO","PAVO","PEDIR","PELO","PENA","PERRO","PESO","PEZ","PIANO","PIE","PIEL","PIEZA","PILOTO","PISO","PLACA","PLAN","PLATA","PLATO","PLAYA","PLAZA","PLUMA","POBRE","POCO","PODER","POLLO","POLVO","PONER","PORTE","POSTRE","POZO","PRECIO","PRIMO","PULSO","PUNTO","QUESO","RADIO","RAIZ","RAMA","RATA","RAZON","RED","RELOJ","REMO","RESTA","RICO","RIEGO","RIO","RISA","ROBO","ROCA","ROJO","ROPA","ROSA","ROTO","RUIDO","RUTA","SABER","SABOR","SAL","SALIR","SALUD","SANTO","SAPO","SECO","SEDA","SELLO","SELVA","SERIE","SILLA","SOL","SOPA","SUAVE","SUELO","SUE√ëO","SUMA","SUR","TABLA","TACO","TALLA","TAPA","TARDE","TAZA","TECHO","TELA","TEMAS","TENER","TENIS","TEXTO","TIEMPO","TIENDA","TIERRA","TIGRE","TINTA","TIO","TIPO","TIRA","TODO","TOMAR","TONO","TORRE","TOTAL","TRAJE","TREN","TRES","TRIGO","TRONO","TUBO","TUL","TUMBA","TURNO","UVA","VACA","VALLE","VALOR","VAPOR","VASO","VELA","VENIR","VERDE","VIAJE","VIDA","VIDRIO","VIEJO","VIENTO","VINO","VISTA","VIVIR","VOLAR","VOZ","VUELO","YATE","YERBA","YESO","YOGA","ZAPATO","ZONA","ZORRO","ZUMO"],
        6: ["CAMINO","PIEDRA","TIEMPO","VIENTO","BOSQUE","CIUDAD","CUERPO","MENTES","PLANTA","PUERTA","COMPRA","ABUELO","ACEITE","ADULTO","AGOSTO","AHORRO","AJEDREZ","ALARMA","ALCALDE","ALEGRE","ALTURA","ALUMNO","AMIGOS","ANILLO","ANIMAL","ANTENA","APOYAR","ARRIBA","ARRUGA","ASUNTO","ATENTO","ATLETA","AVISO","AYUDA","AZUCAR","BAILAR","BALCON","BANANA","BANDERA","BARBA","BARRIO","BASURA","BATALLA","BEBIDA","BELLEZA","BESAR","BICHO","BILLETE","BLANCO","BLOQUE","BOLSAS","BOMBA","BONITO","BOTON","BRAZOS","BRUJA","BUZON","CABALLO","CABINA","CABEZA","CADENA","CAFETERA","CAJON","CALOR","CAMARA","CAMBIO","CAMISA","CAMPO","CANCION","CANSADO","CANTAR","CAPAZ","CAPITAL","CARCEL","CARGA","CARI√ëO","CARNE","CARTA","CARTON","CASCO","CASTIGO","CAUSA","CELULA","CEMENTO","CENIZA","CENTRO","CEPILLO","CEREAL","CEREZA","CERRAR","CESPED","CHARLA","CHICO","CHISTE","CHOQUE","CICLO","CIEGO","CIELO","CIENCIA","CIERTO","CINCO","CINTA","CIRCO","CIVIL","CLARO","CLASE","CLIMA","CLINICA","COBRE","COCINA","CODIGO","COGER","COLEGIO","COLINA","COLOR","COMIDA","COMUN","CONEJO","CONSEJO","CONTAR","COPA","COPIA","CORAZON","CORONA","CORREO","CORTAR","CORTE","COSAS","COSER","COSTA","CRECER","CREMA","CRISIS","CRUCE","CRUDO","CUADRO","CUARTO","CUENTO","CUERDA","CUELLO","CUENTA","CUERPO","CUEVA","CULPA","CULTURA","CURSO","CURVA","DADO","DANZA","DA√ëO","DARDO","DEBER","DEBIL","DECIR","DEDO","DEFENSA","DEJAR","DELITO","DEMAS","DENTRO","DEPORTE","DERECHO","DESEO","DEUDA","DIABLO","DIARIO","DIBUJO","DIENTE","DIETA","DINERO","DISCO","DISE√ëO","DOBLE","DOCENA","DOLOR","DOMINGO","DONDE","DORMIR","DROGA","DUCHA","DUDA","DUE√ëO","DULCE","DURO","ECHAR","EDAD","EFECTO","EJEMPLO","ELEVAR","ELLOS","EMPLEO","EMPUJAR","ENANO","ENCIMA","ENERO","ENFERMO","ENLACE","ENORME","ENTRAR","ENVIO","EPOCA","EQUIPO","ERROR","ESCALA","ESCAPE","ESCENA","ESCOBA","ESCUDO","ESCUELA","ESPADA","ESPALDA","ESPEJO","ESPERA","ESPOSA","ESPOSO","ESTADO","ESTAR","ESTILO","ESTIMA","ESTUDIO","ETAPA","ETERNO","EVENTO","EXAMEN","EXITO","EXTRA","FABRICA","FACIL","FACTOR","FALDA","FALSO","FALTA","FAMILIA","FANTASMA","FAROL","FAVOR","FECHA","FELIZ","FERIA","FIESTA","FIGURA","FILA","FILME","FINAL","FINCA","FIRMA","FISICO","FLACO","FLECHA","FLOR","FLOTA","FLUJO","FONDO","FORMA","FORZAR","FOTO","FRASE","FRENO","FRENTE","FRESA","FRESCO","FRIO","FRUTA","FUEGO","FUENTE","FUERTE","FUERZA","FUMAR","FUTBOL","FUTURO","GAFAS","GALLETA","GALLINA","GANADO","GANAR","GANSO","GARAJE","GARGANTA","GASTO","GATO","GENTE","GESTO","GIGANTE","GIMNASIO","GIRAR","GLOBO","GLORIA","GOLPE","GORDO","GORRA","GOTA","GRACIA","GRADO","GRANO","GRASA","GRATIS","GRAVE","GRIFO","GRIS","GRITO","GROSERO","GRUESO","GRUPO","GUANTE","GUAPO","GUARDIA","GUERRA","GUIA","GUSANO","GUSTO","HABER","HABIL","HABITO","HABLA","HACER","HACHA","HALLAR","HAMBRE","HARINA","HASTA","HECHO","HELADO","HERIDO","HERMANO","HEROE","HIELO","HIERBA","HIERRO","HIGADO","HIJA","HIJO","HILO","HIMNO","HISTORIA","HOGAR","HOJA","HOLA","HOMBRE","HOMBRO","HONDO","HONOR","HORA","HORNO","HOTEL","HUESO","HUEVO","HUIR","HUMANO","HUMEDO","HUMO","HUMOR","IDEAL","IDIOMA","IDOLO","IGLESIA","IGUAL","IMAGEN","IMAN","IMPAR","INDICE","INICIO","INMENSO","INUTIL","INVIERNO","ISLA","JABON","JAMON","JARDIN","JARRA","JAULA","JEFE","JOVEN","JOYA","JUEGO","JUEVES","JUGAR","JUICIO","JULIO","JUNIO","JUNTA","JUNTO","JURADO","JUSTO","JUVENTUD","KILO","LABIO","LABOR","LADO","LADRON","LAGO","LAGRIMA","LANA","LANZAR","LAPIZ","LARGO","LATIN","LAVAR","LECCION","LECHE","LECTOR","LEER","LEGAL","LEGUA","LEJOS","LENGUA","LENTO","LE√ëA","LEON","LETRA","LEVANTAR","LEYENDA","LIBRE","LIBRO","LIDER","LIGERO","LIMITES","LIMON","LIMPIO","LINDO","LINEA","LINGOTE","LIO","LIQUIDO","LIRIO","LISO","LISTA","LISTO","LITRO","LLAMA","LLAMAR","LLANO","LLAVE","LLEGAR","LLENO","LLEVAR","LLORAR","LLUVIA","LOBO","LOCAL","LOCO","LODO","LOGRO","LOMA","LOMO","LONA","LONGITUD","LORO","LOSA","LUCHA","LUCRO","LUGAR","LUJO","LUNA","LUNES","LUZ","MACETA","MACHO","MADERA","MADRE","MAESTRO","MAGIA","MAGO","MAIZ","MALETA","MALO","MAMA","MANCHA","MANDO","MANERA","MANGA","MANGO","MANI","MANO","MANTA","MANTECA","MANZANA","MA√ëANA","MAPA","MAQUINA","MAR","MARAVILLA","MARCA","MARCHA","MARCO","MAREA","MARIDO","MARINERO","MARIPOSA","MARMOL","MARRON","MARTES","MARTILLO","MARZO","MAS","MASA","MASCARA","MASCOTA","MATAR","MATERIA","MATIZ","MAYOR","MAZORCA","MECANICO","MEDALLA","MEDIA","MEDICO","MEDIDA","MEDIO","MEDIR","MEJILLA","MEJOR","MELON","MEMORIA","MENOR","MENOS","MENSAJE","MENTE","MENTIRA","MENU","MERCADO","MERITO","MERMELADA","MES","MESA","META","METAL","METODO","METRO","MEZCLA","MIEDO","MIEL","MIEMBRO","MIGA","MIL","MILAGRO","MILITAR","MILLA","MILLON","MINA","MINERAL","MINIMO","MINUTO","MIRADA","MIRAR","MISA","MISIL","MISMO","MITAD","MITO","MOCHILA","MODA","MODELO","MODERNO","MODO","MOHO","MOJADO","MOLDE","MOLER","MOLINO","MOMENTO","MONEDA","MONJE","MONO","MONTA√ëA","MONTON","MONUMENTO","MORA","MORADO","MORAL","MORDIDA","MORENO","MORIR","MOSCA","MOSQUITO","MOSTRAR","MOTOR","MOVER","MOVIL","MOZO","MUCHACHO","MUCHO","MUEBLE","MUELLE","MUERTE","MUERTO","MUESCA","MUESTRA","MUJER","MULA","MULTA","MUNDO","MU√ëECA","MU√ëECO","MURO","MUSCULO","MUSEO","MUSICA","MUSLO","MUY","NACER","NACION","NADA","NADAR","NADIE","NARANJA","NARIZ","NATA","NATURAL","NAUFRAGIO","NAVAJA","NAVE","NAVIDAD","NECESARIO","NEGAR","NEGOCIO","NEGRO","NENE","NERVIO","NETO","NEUMATICO","NEVAR","NIEBLA","NIETA","NIETO","NIEVE","NIDO","NIEBLA","NI√ëO","NIVEL","NO","NOBLE","NOCHE","NOGAL","NOMBRE","NORMA","NORTE","NOTA","NOTAR","NOTICIA","NOVELA","NOVIA","NOVIO","NUBE","NUCA","NUCLEO","NUDILLO","NUDO","NUERA","NUESTRO","NUEVE","NUEVO","NUEZ","NUMERO","NUNCA","NUTRIA","OBJETO","OBLIGAR","OBRA","OBRERO","OBSERVAR","OBTENER","OCEANO","OCHENTA","OCHO","OCUPAR","ODIO","OESTE","OFERTA","OFICIAL","OFICINA","OFICIO","OIDO","OIR","OJO","OLA","OLER","OLIVA","OLLA","OLMO","OLOR","OLVIDAR","OMBLIGO","ONCE","ONDA","OPCION","OPERAR","OPINION","OPONER","OPORTUNIDAD","ORACION","ORDEN","OREJA","ORGANO","ORGULLO","ORIENTE","ORIGEN","ORILLA","ORO","ORQUESTA","OSCURO","OSO","OSTRA","OTO√ëO","OTRO","OVEJA","OXIGENO","PACIENTE","PACTO","PADRE","PAGA","PAGAR","PAGINA","PAIS","PAISAJE","PAJA","PAJARO","PALA","PALABRA","PALACIO","PALANCA","PALMA","PALO","PALOMA","PAN","PANADERIA","PANTALON","PANTALLA","PANTERA","PA√ëUELO","PAPA","PAPA","PAPEL","PAQUETE","PAR","PARA","PARADA","PARAGUAS","PARAISO","PARAR","PARED","PAREJA","PARIENTE","PARQUE","PARRA","PARTE","PARTIDO","PARTIR","PASADO","PASAJERO","PASAR","PASEO","PASION","PASO","PASTA","PASTEL","PASTO","PATA","PATATA","PATIO","PATO","PATRON","PAUSA","PAUTA","PAVO","PAZ","PECHO","PEDAZO","PEDIDO","PEDIR","PEGAMENTO","PEGAR","PEINAR","PEINE","PELEAR","PELIGRO","PELO","PELOTA","PENA","PENDIENTE","PENSAR","PENSION","PEOR","PEPINO","PEQUE√ëO","PERA","PERCHA","PERDER","PERDON","PERFIL","PERFUME","PERIODICO","PERLA","PERMISO","PERMITIR","PERO","PERRO","PERSONA","PESADO","PESAR","PESCA","PESCADO","PESCUEZO","PESO","PESTA√ëA","PETALO","PETROLEO","PEZ","PIANO","PICO","PIE","PIEDRA","PIEL","PIERNA","PIEZA","PILA","PILAR","PILOTO","PIMIENTA","PINO","PINTURA","PINZAS","PIOJO","PIPA","PISAR","PISCINA","PISO","PISTA","PISTOLA","PITO","PIZARRA","PLACA","PLACER","PLAN","PLANCHA","PLANETA","PLANO","PLANTA","PLATA","PLATANO","PLATO","PLAYA","PLAZA","PLEITO","PLOMO","PLUMA","POBRE","POCO","PODER","PODRIDO","POEMA","POETA","POLICIA","POLITICA","POLLO","POLVO","POMELO","POMO","PONER","POPA","POPULAR","POR","PORCELANA","PORCHE","PORQUE","PORTADA","PORTE","PORTERO","POSIBLE","POSTE","POSTRE","POTENCIA","POZO","PRADO","PRECIO","PREGUNTA","PREMIO","PRENSA","PRESO","PRESTAMO","PRIMAVERA","PRIMERO","PRIMO","PRINCESA","PRINCIPE","PRINCIPIO","PRISA","PRISION","PRIVADO","PROBAR","PROBLEMA","PROCESO","PRODUCTO","PROFESOR","PROFUNDO","PROGRAMA","PROHIBIR","PROMES","PRONTO","PROPINA","PROPIO","PROSA","PROTEINA","PRUEBA","PSICOLOGO","PUBLICO","PUDRIR","PUEBLO","PUENTE","PUERCO","PUERTA","PUERTO","PUESTO","PULGA","PULGADA","PULMON","PULPO","PULSO","PUNTA","PUNTO","PU√ëO","PURA","PURPURA","QUE","QUEBRAR","QUEDAR","QUEJA","QUEMAR","QUERER","QUESO","QUIEN","QUIETO","QUIMICA","QUINCE","QUINTO","QUITAR","RABANO","RABIA","RABO","RACIMO","RADIO","RAIZ","RAMA","RANA","RAPIDO","RAQUETA","RARO","RASCACIELOS","RATA","RATON","RAYA","RAYO","RAZON","REAL","REALIDAD","RECETA","RECIBIR","RECIENTE","RECOGER","RECORDAR","RECTO","RED","REDONDO","REDUCIR","REFLEJO","REFRAN","REGALO","REGLA","REINA","REINO","REIR","REJA","RELACION","RELATO","RELIGION","RELOJ","REMAR","REMEDIO","REMO","RENTA","REPARAR","REPETIR","REPOSO","REPROCHAR","RESERVA","RESPETO","RESPUESTA","RESTA","RESTO","RESULTADO","RETIRO","REUNION","REVISTA","REY","REZAR","RICO","RIEGO","RIESGO","RIFLE","RIO","RIQUEZA","RISA","RITMO","RITO","RIVAL","ROBAR","ROBLE","ROBO","ROBUSTO","ROCA","ROCIO","RODILLA","ROJO","ROLLO","ROMPER","ROPA","ROSA","ROSTRO","ROTO","RUBIO","RUEDA","RUGIDO","RUIDO","RUINA","RUMBO","RUSO","RUTA","SABADO","SABANA","SABER","SABIO","SABOR","SACAR","SACO","SACUDIR","SAGRADO","SAL","SALA","SALIDA","SALIR","SALMON","SALON","SALSA","SALTAR","SALTO","SALUD","SALUDO","SALVAJE","SANGRE","SANTO","SAPO","SASTRE","SATELITE","SAUCE","SECAR","SECO","SECRETARIO","SECRETO","SECTA","SEDA","SEGUIR","SEGUNDO","SEGURIDAD","SEGURO","SEIS","SELECCION","SELLA","SELLO","SELVA","SEMANA","SEMILLA","SE√ëAL","SE√ëOR","SE√ëORA","SENTADO","SENTIDO","SENTIR","SEPARAR","SEPTIEMBRE","SER","SERIE","SERIO","SERPIENTE","SERVICIO","SERVIR","SESENTA","SETECIENTOS","SETENTA","SEXO","SEXTO","SI","SIEMPRE","SIERRA","SIESTA","SIGLO","SIGNIFICADO","SIGNO","SILENCIO","SILLA","SILLON","SIMBOLO","SIMPATICO","SIMPLE","SIN","SINCERO","SINGULAR","SINO","SISTEMA","SITIO","SITUACION","SOBRE","SOBRINA","SOBRINO","SOCIEDAD","SOCIO","SOFA","SOL","SOLDADO","SOLEDAD","SOLIDO","SOLO","SOLTAR","SOLUCION","SOMBRA","SOMBRERO","SONIDO","SONRISA","SOPA","SOPLAR","SOPORTE","SORDO","SORPRESA","SORTIJA","SOSTEN","SOTANO","SUAVE","SUBIR","SUCIO","SUDOR","SUEGRA","SUEGRO","SUELA","SUELDO","SUELO","SUE√ëO","SUERTE","SUFIJO","SUFRIR","SUMA","SUPERIOR","SUR","SURCO","SUSTANCIA","SUSTO","SUTIL","TABACO","TABLA","TABLERO","TACON","TACTO","TAJADA","TALADRO","TALENTO","TALLA","TALLER","TALLO","TALON","TAMA√ëO","TAMBOR","TANQUE","TANTO","TAPA","TAPAR","TAPETE","TAPON","TAQUILLA","TARDE","TAREA","TARJETA","TARRO","TARTA","TAXI","TAZA","TAZON","TE","TEATRO","TECHO","TECLADO","TECNICA","TEJADO","TEJER","TEJIDO","TELA","TELEFONO","TELEVISION","TEMA","TEMER","TEMPERATURA","TEMPLO","TEMPORADA","TEMPRANO","TENDENCIA","TENEDOR","TENER","TENIS","TENSION","TEORIA","TERCERO","TERMINAR","TERMINO","TERNERA","TERRAZA","TERRENO","TERROR","TESORO","TESTIGO","TETERA","TEXTO","TIA","TIBURON","TIEMPO","TIENDA","TIERRA","TIGRE","TIJERAS","TIMBRE","TIMIDO","TIO","TIPO","TIRA","TIRAR","TITULO","TOALLA","TOBILLO","TOCAR","TOCINO","TODO","TOLDO","TOMAR","TOMATE","TONELADA","TONO","TONTO","TOQUE","TORMENTA","TORNEO","TORO","TORPE","TORRE","TORTA","TORTILLA","TORTUGA","TOS","TOSTAR","TOTAL","TRABAJO","TRACTOR","TRADICION","TRADUCIR","TRAER","TRAFICO","TRAGEDIA","TRAJE","TRAMPA","TRAMO","TRANQUILO","TRANVIA","TRAPO","TRASERO","TRATAR","TRATO","TRAYECTO","TRAZAR","TREINTA","TREN","TRENZA","TREPAR","TRES","TRIBU","TRIBUNAL","TRIGO","TRIMESTRE","TRISTE","TRIUNFO","TRONCO","TRONO","TROPA","TROZO","TRUENO","TU","TUBERIA","TUBO","TULIPAN","TUMBA","TUMBAR","TUNEL","TURISMO","TURISTA","TURNO","TUTOR","U√ëA","UN","UNICO","UNIDAD","UNIFORME","UNION","UNIR","UNIVERSO","UNO","UNTAR","U√ëA","URBANO","URGENTE","USAR","USO","UTIL","UVA","VACA","VACACION","VACIO","VAGON","VAINA","VALER","VALIENTE","VALLA","VALLE","VALOR","VALVULA","VAPOR","VARILLA","VARIOS","VARON","VASO","VECINO","VEGETAL","VEHICULO","VEINTE","VEJEZ","VELA","VELERO","VELO","VELOCIDAD","VENA","VENCER","VENDA","VENDEDOR","VENDER","VENENO","VENGA","VENIR","VENTA","VENTANA","VER","VERANO","VERBO","VERDAD","VERDE","VERDURA","VERG√úENZA","VERSO","VERTICAL","VESTIDO","VESTIR","VEZ","VIA","VIAJAR","VIAJE","VIBORA","VICI","VICTIMA","VICTORIA","VIDA","VIDEO","VIDRIO","VIEJO","VIENTO","VIENTRE","VIERNES","VIGA","VIGILAR","VILLA","VINAGRE","VINO","VI√ëA","VIOLIN","VIRGEN","VIRTUD","VISITA","VISPERA","VISTA","VIUDA","VIUDO","VIVIR","VIVO","VOCABLO","VOCAL","VOCACION","VOLAR","VOLCAN","VOLUMEN","VOLUNTAD","VOLVER","VOSOTROS","VOTAR","VOTO","VOZ","VUELO","VUELTA","VUESTRO","VULGAR","Y","YA","YATE","YEGUA","YEMA","YERBA","YERNO","YESO","YO","YODO","YOGA","YUNQUE","ZANAHORIA","ZANJA","ZAPATO","ZARZA","ZONA","ZOOLOGICO","ZORRO","ZUMO","ZURDO"],
        7: ["ESTRELLA","MANZANA","PERSONA","VENTANA","ESCUELA","TRABAJO","FAMILIA","SEMANA","MOMENTO","LUGAR","CIUDAD","TIEMPO","CAMINO","VERDAD","SUE√ëO","CUERPO","MUSICA","AMIGO","NOCHE","FIESTA","PADRE","MADRE","HERMANO","SISTEMA","EJEMPLO","SENTIDO","MIRADA","FUERZA","NOMBRE","GRUPO","CUENTA","HISTORIA","CALLE","BARRIO","PUEBLO","MUNDO","TIERRA","AGUA","FUEGO","VIENTO","JUEGO","EQUIPO","PRUEBA","CLASE","FORMA","PARTE","PUNTO","CASO","HECHO","LADO","NIVEL","ORDEN","PODER","SALUD","AMOR","DOLOR","MIEDO","RAZON","VALOR","IDEAL","LIBRO","PAPEL","CARTA","COLOR","LINEA","FONDO","FIGURA","IMAGEN","BRAZO","PIERNA","CABEZA","MANO","DEDO","LABIO","DIENTE","LENGUA","PELO","CARA","OJOS","NARIZ","OREJA","CUELLO","ESPALDA","PECHO","CORAZON","SANGRE","HUESO","PIEL","AIRE","LLUVIA","NIEVE","CALOR","FRIO","SOL","LUNA","CIELO","NUBE","MAR","RIO","LAGO","MONTE","VALLE","CAMPO","BOSQUE","FLOR","ARBOL","FRUTA","ANIMAL","PERRO","GATO","CABALLO","PAJARO","PEZ","LEON","TIGRE","OSO","LOBO","RATON","VACA","CERDO","OVEJA","GALLINA","HUEVO","LECHE","PAN","QUESO","ARROZ","PASTA","SOPA","ENSALADA","CARNE","PESCADO","AGUA","VINO","CERVEZA","CAFE","TE","AZUCAR","SAL","ACEITE","CASA","EDIFICIO","PUERTA","PARED","TECHO","SUELO","MESA","SILLA","CAMA","ROPA","ZAPATO","SOMBRERO","RELOJ","DINERO","PRECIO","COMPRA","VENTA","TIENDA","MERCADO","BANCO","OFICINA","ESCUELA","COLEGIO","CLASE","ALUMNO","MAESTRO","LIBRO","LAPIZ","PAPEL","CARTA","CORREO","TELEFONO","RADIO","TELE","CINE","TEATRO","MUSICA","BAILE","DEPORTE","FUTBOL","JUEGO","VIAJE","TREN","COCHE","AVION","BARCO","CALLE","PLAZA","PARQUE","JARDIN","CIUDAD","PUEBLO","PAIS","ESTADO","GOBIERNO","LEY","GUERRA","PAZ","VIDA","MUERTE","SALUD","ENFERMO","MEDICO","HOSPITAL","DOLOR","REMEDIO","AMOR","ODIO","ALEGRIA","TRISTEZA","MIEDO","VALOR","ESPERA","DESEO","SUE√ëO","REALIDAD","MENTIRA","VERDAD","ERROR","ACIERTO","DUDA","PREGUNTA","RESPUESTA","PALABRA","SILENCIO","VOZ","GRITO","RISA","LLANTO","BESO","ABRAZO","GOLPE","LUCHA","TRABAJO","DESCANSO","VACACION","FIESTA","REGALO","SORPRESA","SECRETO","RECUERDO","OLVIDO","TIEMPO","HORA","MINUTO","SEGUNDO","DIA","NOCHE","MA√ëANA","TARDE","SEMANA","MES","A√ëO","SIGLO","ESTACION","PRIMAVERA","VERANO","OTO√ëO","INVIERNO","LUNES","MARTES","MIERCOLES","JUEVES","VIERNES","SABADO","DOMINGO","ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE","UNO","DOS","TRES","CUATRO","CINCO","SEIS","SIETE","OCHO","NUEVE","DIEZ","CIEN","MIL","PRIMERO","SEGUNDO","ULTIMO","TODO","NADA","ALGO","MUCHO","POCO","MAS","MENOS","IGUAL","DIFERENTE","GRANDE","PEQUE√ëO","LARGO","CORTO","ALTO","BAJO","ANCHO","ESTRECHO","GORDO","FLACO","FUERTE","DEBIL","RAPIDO","LENTO","NUEVO","VIEJO","JOVEN","BUENO","MALO","MEJOR","PEOR","RICO","POBRE","LINDO","FEO","LIMPIO","SUCIO","SECO","MOJADO","CALIENTE","FRIO","LLENO","VACIO","ABIERTO","CERRADO","FACIL","DIFICIL","CLARO","OSCURO","BLANCO","NEGRO","ROJO","AZUL","VERDE","AMARILLO","NARANJA","ROSA","VIOLETA","GRIS","MARRON","ORO","PLATA","HIERRO","MADERA","PIEDRA","VIDRIO","PAPEL","TELA","PLASTICO","GOMA","CUERO","PIEL","PELO","PLUMA","ALGODON","LANA","SEDA","AGUA","TIERRA","FUEGO","AIRE","LUZ","SOMBRA","SONIDO","RUIDO","OLOR","GUSTO","TACTO","VISTA","OIDO","OLFATO","GUSTO","TACTO","SENTIDO","MENTE","ALMA","ESPIRITU","DIOS","CIELO","INFIERNO","MUNDO","UNIVERSO","SOL","LUNA","ESTRELLA","PLANETA","TIERRA","MAR","RIO","MONTA√ëA","VALLE","CAMPO","CIUDAD","PUEBLO","CASA","HOGAR","FAMILIA","PADRE","MADRE","HIJO","HIJA","HERMANO","HERMANA","ABUELO","ABUELA","TIO","TIA","PRIMO","PRIMA","AMIGO","AMIGA","NOVIO","NOVIA","ESPOSO","ESPOSA","HOMBRE","MUJER","NI√ëO","NI√ëA","BEBE","PERSONA","GENTE","GRUPO","SOCIEDAD","PUEBLO","NACION","PAIS","ESTADO","GOBIERNO","LEY","JUSTICIA","LIBERTAD","PAZ","GUERRA","EJERCITO","POLICIA","LADRON","CRIMEN","CARCEL","CASTIGO","PREMIO","DINERO","TRABAJO","EMPLEO","JEFE","OBRERO","MEDICO","MAESTRO","ABOGADO","JUEZ","POLITICO","ARTISTA","ACTOR","CANTANTE","MUSICO","ESCRITOR","POETA","PINTOR","DEPORTISTA","JUGADOR","EQUIPO","PARTIDO","JUEGO","GANAR","PERDER","EXITO","FRACASO","SUERTE","DESTINO","FUTURO","PASADO","PRESENTE","HISTORIA","VIDA","MUERTE","NACER","VIVIR","MORIR","AMAR","ODIAR","REIR","LLORAR","COMER","BEBER","DORMIR","DESPERTAR","SO√ëAR","PENSAR","CREER","SABER","CONOCER","ENTENDER","APRENDER","ENSE√ëAR","HABLAR","ESCUCHAR","LEER","ESCRIBIR","VER","MIRAR","OIR","TOCAR","SENTIR","MOVER","ANDAR","CORRER","SALTAR","BAILAR","JUGAR","TRABAJAR","DESCANSAR","VIAJAR","VOLVER","IR","VENIR","ENTRAR","SALIR","SUBIR","BAJAR","CAER","LEVANTAR","DAR","RECIBIR","TOMAR","DEJAR","PONER","QUITAR","ABRIR","CERRAR","EMPEZAR","TERMINAR","SEGUIR","ESPERAR","BUSCAR","ENCONTRAR","PERDER","GANAR","COMPRAR","VENDER","PAGAR","COBRAR","GASTAR","AHORRAR","TENER","QUERER","PODER","DEBER","HACER","SER","ESTAR","HABER"]
    };

    let wSolution="", wGrid=[], wRow=0, wCol=0, wOver=false, currentWordleLen=5;

    function initWordle(len) {
        currentWordleLen = len || 5;
        showScreen('screen-wordle-game');
        let pool = WORDLE_DB[currentWordleLen];
        wSolution = pool[Math.floor(Math.random()*pool.length)];
        wGrid = Array(6).fill().map(()=>Array(currentWordleLen).fill(""));
        wRow=0; wCol=0; wOver=false;
        renderWordleBoard(); renderKeyboard();
    }

    function renderWordleBoard() {
        const b = document.getElementById('wordle-board');
        b.style.gridTemplateColumns = `repeat(${currentWordleLen}, 1fr)`;
        b.innerHTML = "";
        for(let r=0; r<6; r++) {
            for(let c=0; c<currentWordleLen; c++) {
                let cell=document.createElement('div'); cell.className='wordle-cell'; cell.id=`w-${r}-${c}`;
                cell.textContent=wGrid[r][c]; b.appendChild(cell);
            }
        }
    }

    function renderKeyboard() {
        const kb = document.getElementById('keyboard'); kb.innerHTML = "";
        ["QWERTYUIOP", "ASDFGHJKL√ë", "ZXCVBNM"].forEach((row,i) => {
            let rowDiv = document.createElement('div'); rowDiv.className = 'key-row';
            if(i===2) { let ent=document.createElement('div'); ent.className='key'; ent.textContent='ENTER'; ent.style.flex='1.5'; ent.onclick=wEnter; rowDiv.appendChild(ent); }
            for(let char of row) { let k=document.createElement('div'); k.className='key'; k.id='key-'+char; k.textContent=char; k.onclick=()=>wInput(char); rowDiv.appendChild(k); }
            if(i===2) { let back=document.createElement('div'); back.className='key'; back.textContent='‚å´'; back.style.flex='1.5'; back.onclick=wBack; rowDiv.appendChild(back); }
            kb.appendChild(rowDiv);
        });
    }

    function wInput(k) { if(wCol<currentWordleLen && !wOver) { wGrid[wRow][wCol]=k; document.getElementById(`w-${wRow}-${wCol}`).textContent=k; wCol++; } }
    function wBack() { if(wCol>0 && !wOver) { wCol--; wGrid[wRow][wCol]= ""; document.getElementById(`w-${wRow}-${wCol}`).textContent=""; } }
    function wEnter() {
        if(wCol<currentWordleLen || wOver) return;
        let guess = wGrid[wRow].join("");
        let solArr = wSolution.split("");
        let colors = Array(currentWordleLen).fill("absent");

        // Green pass
        for(let i=0; i<currentWordleLen; i++) {
            if(wGrid[wRow][i] === solArr[i]) { colors[i] = "correct"; solArr[i] = null; }
        }
        // Yellow pass
        for(let i=0; i<currentWordleLen; i++) {
            if(colors[i] !== "correct" && solArr.includes(wGrid[wRow][i])) {
                colors[i] = "present"; solArr[solArr.indexOf(wGrid[wRow][i])] = null;
            }
        }

        // Apply Colors
        for(let i=0; i<currentWordleLen; i++) {
            let cell = document.getElementById(`w-${wRow}-${i}`);
            let key = document.getElementById(`key-${wGrid[wRow][i]}`);
            setTimeout(() => {
                cell.classList.add(colors[i]);
                if(key) {
                    if(colors[i]==='correct') key.className='key correct';
                    else if(colors[i]==='present' && !key.classList.contains('correct')) key.className='key present';
                    else if(!key.classList.contains('correct') && !key.classList.contains('present')) key.className='key absent';
                }
            }, i*100);
        }

        if(guess === wSolution) {
            wOver=true; 
            setTimeout(() => { fireConfetti(); alert("¬°Correcto!"); checkRecord('wordle', 1); }, (currentWordleLen*100)+100);
        } else if(wRow === 5) {
            wOver=true;
            setTimeout(() => alert("Perdiste. Era: " + wSolution), (currentWordleLen*100)+100);
        } else {
            wRow++; wCol=0;
        }
    }

    /* ================= 2. SIMON ================= */
    let sSeq=[], sInput=[], sLevel=1, simonTimer=null, sActive=false, currentSimonTheme='classic';
    const SIMON_THEMES = {
        classic: { 0:'', 1:'', 2:'', 3:'' },
        days: { 0:'LUN', 1:'MAR', 2:'MIE', 3:'JUE' },
        numbers: { 0:'1', 1:'2', 2:'3', 3:'4' },
        food: { 0:'üçï', 1:'üçî', 2:'üåÆ', 3:'üç¶' }
    };

    function initSimon(theme) {
        currentSimonTheme = theme;
        showScreen('screen-simon-game');
        for(let i=0; i<4; i++) document.getElementById('sb-'+i).textContent = SIMON_THEMES[theme][i];
        stopGame(); sSeq=[]; sLevel=1; 
        document.getElementById('simon-level').textContent=1; 
        document.getElementById('simon-start-btn').style.display='inline-block';
    }
    
    function startSimonRound() { 
        document.getElementById('simon-start-btn').style.display='none'; 
        sInput=[]; sSeq.push(Math.floor(Math.random()*4)); playSeq(); 
    }
    
    function playSeq() { 
        sActive=false; let i=0; 
        simonTimer = setInterval(() => { flashBtn(sSeq[i]); i++; if(i>=sSeq.length) { clearInterval(simonTimer); sActive=true; } }, 800); 
    }
    
    function flashBtn(idx) { 
        let b = document.getElementById('sb-'+idx); 
        b.classList.add('active'); setTimeout(()=>b.classList.remove('active'), 400); 
    }
    
    function handleSimon(idx) { 
        if(!sActive) return; 
        flashBtn(idx); sInput.push(idx); 
        if(sInput[sInput.length-1] !== sSeq[sInput.length-1]) { 
            sActive=false; alert(`¬°Perdiste! Nivel: ${sLevel}`); checkRecord('simon', sLevel); initSimon(currentSimonTheme); return; 
        } 
        if(sInput.length === sSeq.length) { 
            sActive=false; sLevel++; document.getElementById('simon-level').textContent=sLevel; setTimeout(startSimonRound, 1000); 
        } 
    }

    /* ================= 3. SOPA ================= */
    const sopaDB = { paises: ["ARGENTINA","BOLIVIA","BRASIL","CHILE","COLOMBIA","ECUADOR","ESPA√ëA","FRANCIA","ITALIA","JAPON","CHINA","ALEMANIA"], comidas: ["PIZZA","HAMBURGUESA","SUSHI","TACOS","PASTA","ARROZ","POLLO","ENSALADA","HELADO","FRUTA"], animales: ["PERRO","GATO","LEON","TIGRE","ELEFANTE","JIRAFA","OSO","LOBO","AGUILA","DELFIN"], todo: [] };
    sopaDB.todo = [].concat(...Object.values(sopaDB));
    let sGrid=12, sMatrix=[], sWords=[], sFound=[], sCurrentCat='todo', sSwipe=false, sStart=null, sHigh=[];

    function initSopa(cat) { 
        sCurrentCat = cat; showScreen('screen-sopa-game'); 
        document.getElementById('sopa-title').textContent = cat.toUpperCase(); 
        startTimer('timer-sopa'); 
        let pool = sopaDB[cat].sort(()=>Math.random()-0.5); 
        sWords = pool.slice(0, 10); sFound=[]; 
        genSopaGrid(); renderSopa(); 
    }

    function genSopaGrid() { 
        sMatrix = Array(sGrid).fill().map(()=>Array(sGrid).fill('')); 
        let placedList = []; 
        sWords.forEach(w => { 
            if(w.length > sGrid) return; 
            let placed = false, tries=0; 
            while(!placed && tries++<100) { 
                let dir = Math.floor(Math.random()*3), r = Math.floor(Math.random()*sGrid), c = Math.floor(Math.random()*sGrid); 
                if(canPlace(w,r,c,dir)) { 
                    for(let i=0; i<w.length; i++) sMatrix[r + (dir>0?i:0)][c + (dir%2===0?i:0)] = w[i]; 
                    placed = true; placedList.push(w); 
                } 
            } 
        }); 
        sWords = placedList; 
        const abc = "ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ"; 
        for(let r=0; r<sGrid; r++) for(let c=0; c<sGrid; c++) if(!sMatrix[r][c]) sMatrix[r][c] = abc[Math.floor(Math.random()*abc.length)]; 
    }

    function canPlace(w,r,c,d) { 
        let len=w.length, er=r+(d>0?len-1:0), ec=c+(d%2===0?len-1:0); 
        if(er>=sGrid || ec>=sGrid) return false; 
        for(let i=0; i<len; i++) { 
            let nr=r+(d>0?i:0), nc=c+(d%2===0?i:0); 
            if(sMatrix[nr][nc]!=='' && sMatrix[nr][nc]!==w[i]) return false; 
        } 
        return true; 
    }

    function renderSopa() { 
        const g = document.getElementById('sopa-grid'); g.innerHTML=''; 
        for(let r=0; r<sGrid; r++) for(let c=0; c<sGrid; c++) { 
            let d=document.createElement('div'); d.className='cell'; d.textContent=sMatrix[r][c]; d.dataset.r=r; d.dataset.c=c; 
            d.onmousedown=hSopaStart; d.onmouseenter=hSopaMove; d.onmouseup=hSopaEnd; 
            d.ontouchstart=(e)=>{e.preventDefault(); hSopaStart.call(d)}; 
            g.appendChild(d); 
        } 
        g.ontouchmove=(e)=>{e.preventDefault(); let el=document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY); if(el && el.classList.contains('cell')) hSopaMove.call(el)}; 
        g.ontouchend=hSopaEnd; 
        const l = document.getElementById('sopa-words'); l.innerHTML=''; 
        sWords.forEach(w => { let s=document.createElement('div'); s.id='w-'+w; s.textContent=w; s.style.padding="4px 8px"; s.style.background="rgba(128,128,128,0.1)"; s.style.borderRadius="4px"; s.style.fontSize="0.8rem"; l.appendChild(s); }); 
    }

    function hSopaStart() { sSwipe=true; sStart=this; hlSopa(this); }
    function hSopaMove() { if(sSwipe && sStart) hlSopa(this); }
    function hlSopa(end) { 
        sHigh.forEach(c=>c.classList.remove('highlight')); sHigh=[]; 
        let r1=+sStart.dataset.r, c1=+sStart.dataset.c, r2=+end.dataset.r, c2=+end.dataset.c; 
        let dr=r2-r1, dc=c2-c1, st=Math.max(Math.abs(dr),Math.abs(dc)); 
        if(dr!==0 && dc!==0 && Math.abs(dr)!==Math.abs(dc)) return; 
        for(let i=0; i<=st; i++) { 
            let nr=r1+(dr===0?0:dr/st)*i, nc=c1+(dc===0?0:dc/st)*i; 
            let c=document.querySelector(`.cell[data-r="${nr}"][data-c="${nc}"]`); 
            if(c) { c.classList.add('highlight'); sHigh.push(c); } 
        } 
    }

    function hSopaEnd() { 
        if(!sSwipe) return; sSwipe=false; 
        let w = sHigh.map(c=>c.textContent).join(''); 
        let rev = w.split('').reverse().join(''); 
        let match = (sWords.includes(w) && !sFound.includes(w)) ? w : (sWords.includes(rev) && !sFound.includes(rev) ? rev : null); 
        if(match) { 
            sFound.push(match); sHigh.forEach(c=>{c.classList.remove('highlight'); c.classList.add('found')}); 
            let lbl = document.getElementById('w-'+match); if(lbl) { lbl.style.background="#27ae60"; lbl.style.color="white"; lbl.style.textDecoration="line-through"; } 
            if(sFound.length === sWords.length) { stopGame(); fireConfetti(); setTimeout(()=>checkRecord('sopa', timeElapsed), 500); } 
        } else { sHigh.forEach(c=>c.classList.remove('highlight')); } 
        sHigh=[]; sStart=null; 
    }

    /* ================= 4. SUDOKU ================= */
    let suSol=[], suPuz=[], suSel=null;
    function initSudoku() { 
        showScreen('screen-sudoku'); startTimer('timer-sudoku'); 
        let b=[[1,2,3,4,5,6,7,8,9],[4,5,6,7,8,9,1,2,3],[7,8,9,1,2,3,4,5,6],[2,3,4,5,6,7,8,9,1],[5,6,7,8,9,1,2,3,4],[8,9,1,2,3,4,5,6,7],[3,4,5,6,7,8,9,1,2],[6,7,8,9,1,2,3,4,5],[9,1,2,3,4,5,6,7,8]]; 
        let m=[1,2,3,4,5,6,7,8,9].sort(()=>Math.random()-0.5); 
        suSol=b.map(r=>r.map(n=>m[n-1])); suPuz=suSol.map(r=>[...r]); 
        let h=40; while(h>0){ let r=Math.floor(Math.random()*9),c=Math.floor(Math.random()*9); if(suPuz[r][c]!==0){suPuz[r][c]=0;h--;}} 
        const db=document.getElementById('sudoku-board'); db.innerHTML=''; suSel=null; 
        for(let i=0; i<81; i++) { 
            let d=document.createElement('div'); d.className='sudo-cell'; let r=Math.floor(i/9), c=i%9, v=suPuz[r][c]; 
            if(v!==0) { d.textContent=v; d.classList.add('fixed'); } 
            else d.onclick=()=>{ if(suSel) suSel.classList.remove('selected'); suSel=d; d.classList.add('selected'); }; 
            db.appendChild(d); 
        } 
    }
    function fillSudoku(n) { if(suSel) { suSel.textContent=n?n:''; suSel.classList.remove('error'); } }
    function checkSudoku() { 
        let err=0, mt=0, cells=document.querySelectorAll('.sudo-cell'); 
        cells.forEach((c,i)=>{ 
            let v=parseInt(c.textContent)||0; 
            if(v===0) mt++; 
            else if(v!==suSol[Math.floor(i/9)][i%9] && !c.classList.contains('fixed')) { 
                c.style.background='rgba(231,76,60,0.3)'; err++; 
            } 
        }); 
        if(err===0 && mt===0) { stopGame(); fireConfetti(); setTimeout(()=>checkRecord('sudoku', timeElapsed), 500); } 
        else alert(`Errores: ${err}, Vac√≠os: ${mt}`); 
    }

    /* ================= 5. MEMORIA (Fixed 4x4) ================= */
    const memThemes = {
        frutas: ["üçé","üçå","üçí","üçá","üçâ","üçì","üçë","üçç"],
        deportes: ["‚öΩ","üèÄ","üèà","üéæ","üé±","üé≥","‚õ≥","ü•ä"],
        animales: ["üê∂","üê±","üê≠","üêπ","üê∞","ü¶ä","üêª","üêº"],
        caras: ["üòÄ","üòé","üòç","ü§î","üò¥","ü§¢","ü§°","üëª"],
        clima: ["‚òÄÔ∏è","üå§Ô∏è","‚òÅÔ∏è","üåßÔ∏è","‚õàÔ∏è","‚ùÑÔ∏è","üå™Ô∏è","üåà"],
        vehiculos: ["üöó","üöï","üöô","üöå","üèéÔ∏è","üöì","üöë","üö≤"]
    };
    let memCards=[], memLock=false;
    function initMemory() { 
        showScreen('screen-memory'); startTimer('timer-memory'); 
        const g=document.getElementById('memory-grid'); g.innerHTML=''; memCards=[]; memLock=false; 
        const keys = Object.keys(memThemes); const themeKey = keys[Math.floor(Math.random() * keys.length)]; 
        document.getElementById('memo-theme-label').textContent = "Tema: " + themeKey.charAt(0).toUpperCase() + themeKey.slice(1);
        let deck = [...memThemes[themeKey], ...memThemes[themeKey]].sort(()=>Math.random()-0.5); 
        deck.forEach(icon => { 
            let c = document.createElement('div'); c.className = 'card'; c.textContent = icon; 
            c.onclick = () => { 
                if(memLock || c.classList.contains('flipped')) return; 
                c.classList.add('flipped'); memCards.push({ el: c, icon: icon }); 
                if(memCards.length === 2) { 
                    memLock = true; 
                    if(memCards[0].icon === memCards[1].icon) { 
                        memCards = []; memLock = false; 
                        if(document.querySelectorAll('.card.flipped').length === deck.length) { stopGame(); fireConfetti(); setTimeout(()=>checkRecord('memo', timeElapsed), 500); } 
                    } else { 
                        setTimeout(() => { memCards[0].el.classList.remove('flipped'); memCards[1].el.classList.remove('flipped'); memCards = []; memLock = false; }, 1000); 
                    } 
                } 
            }; 
            g.appendChild(c); 
        }); 
    }

    /* ================= 6. MATH ================= */
    let mScore=0, mTime=30, mAns=0, mathTimer=null;
    function initMath() { stopGame(); showScreen('screen-math'); mScore=0; mTime=30; document.getElementById('math-score').textContent="0"; document.getElementById('math-time').textContent="30"; nextMath(); mathTimer = setInterval(() => { mTime--; document.getElementById('math-time').textContent=mTime; if(mTime<=0) { stopGame(); alert("Tiempo!"); checkRecord('math', mScore); goHome(); } }, 1000); }
    function nextMath() { 
        let a=Math.floor(Math.random()*12)+1, b=Math.floor(Math.random()*12)+1, op=Math.random()<0.5?'+':'-'; if(Math.random()>0.7) op='*'; if(op==='*'){a=Math.floor(Math.random()*9)+1; b=Math.floor(Math.random()*9)+1;} 
        mAns = eval(`${a}${op}${b}`); document.getElementById('math-eq').textContent = `${a} ${op} ${b}`; 
        let opts = [mAns]; while(opts.length<4) { let f=mAns+Math.floor(Math.random()*10)-5; if(f!==mAns && !opts.includes(f)) opts.push(f); } opts.sort(()=>Math.random()-0.5); 
        const c = document.getElementById('math-opts'); c.innerHTML=''; 
        opts.forEach(o => { 
            let b=document.createElement('button'); b.className='btn'; b.style.background='var(--card-bg)'; b.textContent=o; b.style.fontSize="1.5rem"; 
            b.onclick=()=>{ 
                if(o===mAns) { mScore+=10; document.getElementById('math-score').textContent=mScore; nextMath(); } 
                else { mScore=Math.max(0,mScore-5); document.getElementById('math-score').textContent=mScore; } 
            }; 
            c.appendChild(b); 
        }); 
    }

    updateRecordDisplay();
</script>
</body>
</html>
